<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>RPL - Using smoltcp RPL</title>


        <!-- Custom HTML head -->
        <link href='https://fonts.googleapis.com/css?family=JetBrains Mono' rel='stylesheet'>

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Using smoltcp</li><li class="chapter-item expanded "><a href="using_smoltcp.html"><strong aria-hidden="true">1.</strong> Setting up a basic stack</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Adding sockets</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Adding RPL</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Adding DNS</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> Feature flags</div></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Protocols</li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> 6LoWPAN</div></li><li class="chapter-item expanded "><a href="rpl_introduction.html" class="active"><strong aria-hidden="true">7.</strong> RPL</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="mop0.html"><strong aria-hidden="true">7.1.</strong> MOP0</a></li><li class="chapter-item expanded "><a href="mop1.html"><strong aria-hidden="true">7.2.</strong> MOP1</a></li><li class="chapter-item expanded "><a href="mop2.html"><strong aria-hidden="true">7.3.</strong> MOP2</a></li><li class="chapter-item expanded "><a href="mop3.html"><strong aria-hidden="true">7.4.</strong> MOP3</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="about.html">About</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Using smoltcp RPL</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="routing-protocol-for-low-power-and-lossy-networks"><a class="header" href="#routing-protocol-for-low-power-and-lossy-networks">Routing Protocol for Low-Power and Lossy Networks</a></h1>
<p>A Wireless Sensor Network (WSN) is a type of Low-Power and Lossy Network (LLN) 
that consists of small, constrained devices equipped with sensors and/or actuators. 
These devices are connected to the Internet and an end user through a central node 
known as the sink node. 
WSNs may include hundreds of these tiny, battery-powered devices that communicate 
with each other using short-range radio transmissions. 
In order to transmit data from one device to another, intermediate nodes act as relay nodes, 
forwarding the data along a multi-hop path towards the sink node. 
The use of low-power, lossy radio links, battery-powered nodes, 
and mesh topologies creates significant routing challenges for LLNs and WSNs.</p>
<p><img src="assets/rpl_intro/rpl_intro2.svg" alt="Empty RPL network" /></p>
<p>To address these challenges, the IETF Routing over Low-Power and Lossy Networks working group developed 
<a href="https://datatracker.ietf.org/doc/html/rfc6550"><strong>IPv6 Routing protocol for Low-power and Lossy Networks (RPL)</strong></a>. RPL supports <em>Point to Point (<strong>P2P</strong>)</em>, <em>Multipoint to Point (<strong>M2P</strong>)</em> and <em>Point to Multipoint (<strong>P2M</strong>)</em> traffic. 
<strong>P2P</strong> communication occurs between two nodes, <strong>M2P</strong> communication involves 
data being sent from multiple nodes to a central node, and <strong>P2M</strong> communication 
involves data being sent from a central node to multiple nodes. RPL uses <strong>upward</strong> 
and <strong>downward routes</strong> to facilitate these different types of traffic. Upward routes 
lead towards the root of the network, while downward routes start at the root and lead 
towards other nodes in the network.</p>
<h2 id="destination-oriented-directed-acyclic-graph-dodag"><a class="header" href="#destination-oriented-directed-acyclic-graph-dodag">Destination Oriented Directed Acyclic Graph (DODAG)</a></h2>
<p>RPL specifies how to construct a Directed Acyclic Graph (DAG) rooted at a single destination, 
known as a Destination-Oriented DAG (DODAG), using an objective function and a set of metrics and constraints. 
The objective function evaluates a combination of metrics and constraints to determine 
the &quot;best&quot; path for packets to follow.</p>
<h2 id="general-concepts"><a class="header" href="#general-concepts">General Concepts</a></h2>
<p>In a WSN, the <strong>neighbors</strong> of a particular node are all the nodes that can be reached via single hop radio links.
In the example below, the neighbors of node 3 are: node 1, 2, 4, and 5. </p>
<p>The <strong>parents</strong> of a node are all its neighbors that are part of a possible route to the sink node. 
In the example below the parents of node 3 are node 1 and 2. The <strong>preferred parent</strong> 
of a node is the neighbor that is on the best route from the node to the sink, such as node 1 for node 3.</p>
<p><img src="assets/rpl_intro/rpl_intro1.svg" alt="Empty RPL network" /></p>
<p>In a network using RPL, the <strong>rank</strong> of each node is a measure of its distance from the root node. 
This rank is determined using <strong>routing metrics</strong>, which include characteristics of both 
the <strong>links</strong> (such as throughput, latency, link reliability, expected transmission count, 
link quality level) and the <strong>nodes</strong> (such as energy state). 
These metrics are used in <strong>objective functions</strong> to calculate the cost of a route between nodes. </p>
<p>A <strong>RPL instance</strong> is a group of DODAGs that have the same RPL instance ID and share a common root node, 
identified by a DODAG ID. The <strong>DODAG version number</strong> is a counter that is incremented by the root node 
whenever a new version of the DODAG is created.</p>
<h2 id="control-messages-upward-and-downward-routes--modes-of-operation"><a class="header" href="#control-messages-upward-and-downward-routes--modes-of-operation">Control Messages, Upward and Downward Routes,  Modes of Operation</a></h2>
<p>The DODAG is created with the assistance of control messages, specifically ICMPv6 messages. 
The four types of control messages that RPL uses to construct the DODAG are:</p>
<ul>
<li>
<p>DODAG Information Object (<strong>DIO</strong>)</p>
</li>
<li>
<p>Destination Advertisement Object (<strong>DAO</strong>)</p>
</li>
<li>
<p>Destination Advertisement Object Acknowledgment (<strong>DAO-ACK</strong>)</p>
</li>
<li>
<p>DODAG Information Solicitation (<strong>DIS</strong>).</p>
</li>
</ul>
<p>RPL uses two types of routes to enable communication within a network: <strong>upward routes</strong> and <strong>downward routes</strong>. 
<strong>Upward routes</strong> are used for M2P communication and are discovered and maintained using DIO messages. 
<strong>Downward routes</strong>, on the other hand, enable P2M and P2P communication and are established using DAO messages.</p>
<p>RPL supports two modes of downward traffic: <strong>storing</strong> and <strong>non-storing</strong>. In the <strong>storing (fully stateful) mode</strong>, 
each node maintains a downward <strong>routing table</strong> and traffic travels only as far as a common parent node. 
In the <strong>non-storing (fully source routed) mode</strong>, all traffic is sent to the root node, which then uses <strong>source routes</strong> to send 
the traffic to its destination. This mode does not require each node to maintain a routing table, but it increases the dependency 
on the root node and the latency of the communication.</p>
<p>The exchange of control messages during the construction of the DODAG may vary depending on the mode of operation that is set for RPL.
In some modes of operation, some of these messages may not be sent at all. 
The mode of operation determines the specific message exchange that occurs during the construction of the DODAG.</p>
<p>There are 4 modes of operation (<strong>MOP</strong>) defined in the RPL standard:</p>
<ol>
<li>
<p><strong>MOP 0 = no downward routes maintained</strong></p>
<p>In this MOP, DAO messages are disabled and the DODAG only maintains upward routes. 
This means that nodes will not transmit or will ignore the DAO messages. 
However, DIO and DIS messages are still sent. In this MOP, only M2P communication is possible.</p>
</li>
<li>
<p><strong>MOP 1 = non storing mode</strong></p>
<p>In this MOP, both upward and downward routes are supported within the DODAG. 
Thus, DIO, DIS, and DAO messages are issued. 
As this is a non-storing mode, the DAO messages are sent to the root. 
In this MOP, all three types of communication are possible: M2P, P2M, and P2P. 
However, multicast is not supported in this MOP.</p>
</li>
<li>
<p><strong>MOP 2 = storing mode with no multicast support</strong></p>
<p>In this MOP, support is provided for both upward and downward routes within the DODAG. 
This is achieved through the issuance of DIO, DIS, and DAO messages. 
As this is a storing mode, the DAO messages are sent to the preferred parent. 
In this MOP, all three types of communication are possible: M2P, P2M, and P2P.
However, multicast is not supported in this MOP.</p>
</li>
<li>
<p><strong>MOP 3 = storing mode with multicast support</strong></p>
<p>This MOP is similar to MOP2, but includes support for multicast. </p>
</li>
</ol>
<p>The root and nodes that are already part of a DODAG advertise this MOP. 
The MOP is included in the DIO messages. 
In order to join the network, nodes must support the MOP advertised in the DIO messages, 
otherwise, they can only join the network as leaf nodes.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="using_smoltcp.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="mop0.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="using_smoltcp.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="mop0.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
